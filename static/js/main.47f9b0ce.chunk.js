(this["webpackJsonptype-tetris"]=this["webpackJsonptype-tetris"]||[]).push([[0],{12:function(a,t,e){},13:function(a,t,e){},15:function(a,t,e){"use strict";e.r(t);var c=e(1),n=e.n(c),r=e(3),i=e.n(r),s=(e(12),e(4)),o=e(5),u=e(7),d=e(6);e(13);function l(a){switch(a.case){case"unit":return"Unit";case"arrow":return"(".concat(l(a.domain)," -> ").concat(l(a.codomain),")");case"variable":return(t=a.id)<v.length?"".concat(v[t%v.length].toUpperCase()):"".concat(v[t%v.length].toUpperCase()).concat(Math.floor(t/v.length))}var t}function p(a){switch(a.case){case"unit":return"unit";case"variable":return h(a.id);case"abstraction":return"(".concat(h(a.id)," : ").concat(l(a.domain),") \u21d2 ").concat(p(a.body));case"application":return"(".concat(p(a.applicant)," ").concat(p(a.argument),")");case"hole":return"#".concat(a.id)}}function h(a){return a<v.length?"".concat(v[a%v.length]):"".concat(v[a%v.length]).concat(Math.floor(a/v.length))}var v=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];function f(a){var t=new Map,e=new Map,c=new Map,n=new Map,r=[];function i(a){var t=c.get(a);if(void 0!==t)return t;throw new Error("undefined variable: ".concat(a))}function s(a){switch(a.case){case"unit":return a;case"variable":if(void 0!==a.id){var t=n.get(a.id);return void 0!==t?s(t):a}throw new Error("unidentified variable");case"arrow":return{case:"arrow",domain:s(a.domain),codomain:s(a.codomain)}}}function o(){var a=0;n.forEach((function(t,e){return a=Math.max(a,e)}));var t=a+1;return n.set(t,void 0),{case:"variable",id:t}}function u(a,t){switch(a.case){case"unit":switch(t.case){case"unit":return{case:"unit"};case"variable":return n.set(t.id,a),a;case"arrow":throw new Error("cannot unify ".concat(l(a)," with ").concat(l(t)))}break;case"variable":switch(t.case){case"unit":case"variable":case"arrow":return n.set(a.id,t),t}break;case"arrow":switch(t.case){case"unit":throw new Error("cannot unify ".concat(l(a)," with ").concat(l(t)));case"variable":return n.set(t.id,a),a;case"arrow":return u(a.domain,t.domain),u(a.codomain,t.codomain),a}}}!function a(t){switch(t.case){case"unit":case"variable":break;case"abstraction":t.domain=s(t.domain);break;case"application":a(t.applicant),a(t.argument)}}(a);var d=s(function a(n){switch(n.case){case"unit":return{case:"unit"};case"variable":return i(n.id);case"abstraction":c.set(n.id,n.domain),r.push(n.id);var s=a(n.body);return r.pop(),{case:"arrow",domain:n.domain,codomain:s};case"application":var d=a(n.applicant),l=o(),p=o();return u(d,{case:"arrow",domain:l,codomain:p}),u(a(n.argument),l),p;case"hole":var h=o();return e.set(n.id,h),t.set(n.id,r.map((function(a){return a}))),h}}(a)),p=new Map;t.forEach((function(a,t){var e=new Map;a.forEach((function(a){return e.set(a,s(i(a)))})),p.set(t,e)})),e.forEach((function(a){return s(a)}));var h=0;n.forEach((function(a,t){return h=Math.max(t,h)}));c.forEach((function(a,t){return h=Math.max(t,0)}));var v=0;return e.forEach((function(a,t){return v=Math.max(t,v)})),{type:d,holeTypes:e,holeContexts:p,maxVariableId:0,maxTypeVariableId:h,maxHoleId:v}}function b(a,t,e){var c=new Map,n=new Map;function r(a){switch(a.case){case"unit":return a;case"variable":if(void 0!==a.id){var t=n.get(a.id);return void 0!==t?r(t):a}throw new Error("unidentified variable");case"arrow":return{case:"arrow",domain:r(a.domain),codomain:r(a.codomain)}}}function i(){var a=0;n.forEach((function(t,e){return a=Math.max(a,e)}));var t=a+1;return n.set(t,void 0),{case:"variable",id:t}}function s(a,t){switch(a.case){case"unit":switch(t.case){case"unit":return{case:"unit"};case"variable":return n.set(t.id,a),a;case"arrow":throw new Error("cannot unify ".concat(l(a)," with ").concat(l(t)))}break;case"variable":switch(t.case){case"unit":case"variable":case"arrow":return n.set(a.id,t),t}break;case"arrow":switch(t.case){case"unit":throw new Error("cannot unify ".concat(l(a)," with ").concat(l(t)));case"variable":return n.set(t.id,a),a;case"arrow":return s(a.domain,t.domain),s(a.codomain,t.codomain),a}}}!function a(t){switch(t.case){case"unit":return{case:"unit"};case"variable":return function(a){var t=c.get(a);if(void 0!==t)return t;throw new Error("undefined variable: ".concat(a))}(t.id);case"abstraction":var e=a(t.body);return{case:"arrow",domain:t.domain,codomain:e};case"application":var n=a(t.applicant),r=i(),o=i();return s(n,{case:"arrow",domain:r,codomain:o}),s(a(t.argument),r),o;case"hole":return i()}}(a),t=r(t),e=r(e);try{return s(t,e),!0}catch(o){return!1}}function m(a){return"term: ".concat(p(a.term),"; type: ").concat(l(a.type),"; focus: ").concat(void 0!==(t=a.focus)?"id: ".concat(t.id,"; type: ").concat(l(t.type),"; context: ").concat(function(a){var t="";return a.forEach((function(a,e){return t+="(".concat(h(e),": ").concat(l(a),")")})),t}(t.context),"; transitions: ").concat(t.transitions.map((function(a){return w(a)}))):"unfocussed");var t}function w(a){switch(a.case){case"select":return"select hole id ".concat(a.id);case"put":return"put ".concat(j(a.put))}}function j(a){switch(a.case){case"unit":return"unit";case"variable":return h(a.id);case"abstraction":return"(".concat(h(a.id),": ").concat(l(a.domain),") \u21d2 ?");case"application":return"? ?"}}function x(a,t){switch(console.log("update"),console.log("input state: ".concat(m(a))),console.log("transition: ".concat(w(t))),t.case){case"select":var e=f(a.term),c=e.holeContexts.get(t.id),n=e.holeTypes.get(t.id),r=[],i=e.maxVariableId+1,s=e.maxTypeVariableId+1;switch(n.case){case"unit":r.push({case:"put",put:{case:"unit"}}),r.push({case:"put",put:{case:"application"}});break;case"arrow":r.push({case:"put",put:{case:"abstraction",domain:n.domain,id:i}}),r.push({case:"put",put:{case:"application"}});break;case"variable":r.push({case:"put",put:{case:"unit"}}),r.push({case:"put",put:{case:"abstraction",domain:{case:"variable",id:s},id:i}}),r.push({case:"put",put:{case:"application"}})}c.forEach((function(t,e){b(a.term,t,n)&&r.push({case:"put",put:{case:"variable",id:e}})})),function(a){var t=[];function e(a){switch(a.case){case"unit":case"variable":break;case"abstraction":e(a.body);break;case"application":e(a.applicant),e(a.argument);break;case"hole":t.push(a.id)}}return e(a),t}(a.term).forEach((function(a){r.push({case:"select",id:a})})),a.focus={id:t.id,type:n,context:c,transitions:r};break;case"put":var o,u=a.focus,d=f(a.term).maxHoleId+1;switch(t.put.case){case"unit":o=y(a.term,u.id,{case:"unit"});break;case"variable":o=y(a.term,u.id,{case:"variable",id:t.put.id});break;case"abstraction":var l={case:"hole",id:d};o=y(a.term,u.id,{case:"abstraction",id:t.put.id,domain:t.put.domain,body:l});break;case"application":var p={case:"hole",id:d},h={case:"hole",id:d+1};o=y(a.term,u.id,{case:"application",applicant:p,argument:h})}if(void 0===o)throw new Error("impossible");var v=f(o);a.term=o,a.type=v.type,a.focus=void 0}return console.log("output state: ".concat(m(a))),a}function y(a,t,e){return function a(t){switch(t.case){case"unit":case"variable":return t;case"abstraction":return{case:"abstraction",id:t.id,domain:t.domain,body:a(t.body)};case"application":return{case:"application",applicant:a(t.applicant),argument:a(t.argument)};case"hole":return e}}(a)}var g=e(0),k=function(a){Object(u.a)(e,a);var t=Object(d.a)(e);function e(){var a;Object(s.a)(this,e);for(var c=arguments.length,n=new Array(c),r=0;r<c;r++)n[r]=arguments[r];return(a=t.call.apply(t,[this].concat(n))).state={term:{case:"hole",id:0},type:{case:"variable",id:0},focus:void 0},a}return Object(o.a)(e,[{key:"render",value:function(){return Object(g.jsxs)("div",{className:"App",children:[this.viewConsole(),Object(g.jsx)("hr",{}),this.viewGoal(),Object(g.jsx)("hr",{}),this.viewContext(),Object(g.jsx)("hr",{}),this.viewPalette()]})}},{key:"viewContext",value:function(){if(void 0!==this.state.focus){var a=[];return this.state.focus.context.forEach((function(t,e){return a.push(Object(g.jsxs)("div",{className:"context-variable",children:[h(e),": ",l(t)]}))})),Object(g.jsxs)("div",{className:"context",children:["Context: ",a]})}return Object(g.jsx)("div",{})}},{key:"viewGoal",value:function(){return void 0!==this.state.focus?Object(g.jsxs)("div",{className:"goal",children:["Goal: ",l(this.state.type)]}):Object(g.jsx)("div",{})}},{key:"viewConsole",value:function(){var a=this;return Object(g.jsxs)("div",{className:"console",children:[function t(e){switch(e.case){case"unit":case"variable":return Object(g.jsx)("span",{children:p(e)});case"abstraction":var c=t(e.body);return Object(g.jsxs)("span",{children:["((",h(e.id),": ",l(e.domain),") \u21d2 ",c,")"]});case"application":var n=t(e.applicant),r=t(e.argument);return Object(g.jsxs)("span",{children:["(",n," ",r,")"]});case"hole":var i=void 0!==a.state.focus&&a.state.focus.id===e.id?"hole focussed":"hole";return Object(g.jsxs)("span",{className:i,onClick:function(t){return a.setState(x(a.state,{case:"select",id:e.id}))},children:["#",e.id]})}}(this.state.term)," : ",l(this.state.type)]})}},{key:"viewPalette",value:function(){if(void 0!==this.state.focus){var a=this,t=[];return this.state.focus.transitions.forEach((function(e){switch(e.case){case"select":break;case"put":t.push(Object(g.jsx)("div",{className:"palette-item",onClick:function(t){return a.setState(x(a.state,e))},children:j(e.put)}))}})),Object(g.jsx)("div",{className:"palette",children:t})}return Object(g.jsx)("div",{})}}]),e}(n.a.Component),E=function(a){a&&a instanceof Function&&e.e(3).then(e.bind(null,16)).then((function(t){var e=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,i=t.getTTFB;e(a),c(a),n(a),r(a),i(a)}))};i.a.render(Object(g.jsx)(n.a.StrictMode,{children:Object(g.jsx)(k,{})}),document.getElementById("root")),E()}},[[15,1,2]]]);
//# sourceMappingURL=main.47f9b0ce.chunk.js.map