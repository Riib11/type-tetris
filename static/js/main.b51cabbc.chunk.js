(this["webpackJsonptype-tetris"]=this["webpackJsonptype-tetris"]||[]).push([[0],{12:function(a,e,t){},13:function(a,e,t){},15:function(a,e,t){"use strict";t.r(e);var r=t(1),c=t.n(r),n=t(3),i=t.n(n),s=(t(12),t(4)),o=t(5),u=t(7),p=t(6);t(13);function l(a){switch(a.case){case"nil":return{case:"nil"};case"cons":return{case:"cons",head:a.head,tail:l(a.tail)}}}function d(a){var e=[];return function a(t){switch(t.case){case"nil":return;case"cons":return e.push(t.head),void a(t.tail)}}(a),e.reverse()}function h(a,e){return{case:"cons",head:a,tail:e}}function v(a){switch(a.case){case"unit":return"Unit";case"variable":return b(a.id);case"arrow":return"(".concat(v(a.domain)," \u2192 ").concat(v(a.codomain),")");case"product":return"(".concat(v(a.part1)," * ").concat(v(a.part2),")")}}function b(a){var e=y[a%y.length],t=a>y.length?Math.floor(a/y.length).toString():"";return"".concat(e).concat(t)}function f(a){switch(a.case){case"unit":return"unit";case"variable":return m(a.id);case"abstraction":return"(\u03bb ".concat(f(a.body),")");case"application":return"(".concat(f(a.applicant)," ").concat(f(a.argument),")");case"pair":return"(".concat(f(a.part1),", ").concat(f(a.part2),")");case"proj1":return"(\u03c0\u2081 ".concat(f(a.argument),")");case"proj2":return"(\u03c0\u2082 ".concat(f(a.argument),")");case"hole":return w(a.id)}}function m(a){return"#".concat(a.toString())}function w(a){return"?".concat(a)}var y=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];function j(a,e){switch(a.case){case"nil":return e;case"cons":return j(a.tail,{case:"cons",key:a.key,value:a.value,tail:e})}}function g(a,e){return{case:"cons",key:a,value:e,tail:{case:"nil"}}}function k(a){return d(a).map((function(a,e){return"".concat(e,": ").concat(v(a))})).join(", ")}function x(a,e){switch(a.case){case"nil":throw new Error("variable id out-of-bounds");case"cons":return 0===e?a.head:x(a.tail,e-1)}}function O(a){var e=function(a){var e=0;function t(){var a={case:"variable",id:e};return e++,a}return function a(e,r){switch(r.case){case"unit":return{case:"unit"};case"variable":return{case:"variable",id:r.id,type:x(e,r.id)};case"abstraction":var c=t(),n=a({case:"cons",head:c,tail:e},r.body);return{case:"abstraction",body:n,type:{case:"arrow",domain:c,codomain:F(n)}};case"application":return{case:"application",applicant:a(e,r.applicant),argument:a(e,r.argument),type:t()};case"pair":return{case:"pair",part1:a(e,r.part1),part2:a(e,r.part2),type:t()};case"proj1":return{case:"proj1",argument:a(e,r.argument),type:t()};case"proj2":return{case:"proj2",argument:a(e,r.argument),type:t()};case"hole":return{case:"hole",id:r.id,type:t()}}throw new Error("impossible")}({case:"nil"},a)}(a),t=function(a){var e={case:"nil"};return a.forEach((function(a){var t=A(S(e,a[0]),S(e,a[1]));e=j(e,t)})),e}(function(a){var e={case:"cons",head:a,tail:{case:"nil"}},t=[],r=P(a);function c(){var a={case:"variable",id:r};return r++,a}for(;"nil"!==e.case;){var n=e.head;switch(e=e.tail,n.case){case"unit":case"variable":break;case"abstraction":e=h(n.body,e);break;case"application":var i=[F(n.applicant),F(n.argument)],s=i[0],o=i[1];e=h(n.argument,e),e=h(n.applicant,e),t.push([s,{case:"arrow",domain:o,codomain:F(n)}]);break;case"pair":var u=[F(n.part1),F(n.part2)],p=u[0],l=u[1];e=h(n.part1,e),e=h(n.part2,e),t.push([{case:"product",part1:p,part2:l},n.type]);break;case"proj1":var d=c();e=h(n.argument,e),t.push([F(n.argument),{case:"product",part1:F(n),part2:d}]);break;case"proj2":var v=c();e=h(n.argument,e),t.push([F(n.argument),{case:"product",part1:v,part2:F(n)}])}}return t.reverse()}(e));return{termAnn:e=function(a){var e=new Map,t=0;function r(a){var r=e.get(a);return void 0!==r||(e.set(a,t),r=t,t++),r}function c(a){switch(a.case){case"unit":return{case:"unit"};case"variable":return{case:"variable",id:r(a.id)};case"arrow":return{case:"arrow",domain:c(a.domain),codomain:c(a.codomain)};case"product":return{case:"product",part1:c(a.part1),part2:c(a.part2)}}}function n(a){switch(a.case){case"unit":return{case:"unit"};case"variable":return{case:"variable",id:a.id,type:c(a.type)};case"abstraction":return{case:"abstraction",body:n(a.body),type:c(a.type)};case"application":return{case:"application",applicant:n(a.applicant),argument:n(a.argument),type:c(a.type)};case"pair":return{case:"pair",part1:n(a.part1),part2:n(a.part2),type:c(a.type)};case"proj1":return{case:"proj1",argument:n(a.argument),type:c(a.type)};case"proj2":return{case:"proj2",argument:n(a.argument),type:c(a.type)};case"hole":return{case:"hole",id:a.id,type:c(a.type)}}}return c(F(a)),n(a)}(e=E(t,e)),type:F(e),substitution:t,holeContexts:C(e)}}function E(a,e){switch(e.case){case"unit":return e;case"variable":return{case:"variable",id:e.id,type:S(a,e.type)};case"abstraction":return{case:"abstraction",body:E(a,e.body),type:S(a,e.type)};case"application":return{case:"application",applicant:E(a,e.applicant),argument:E(a,e.argument),type:S(a,e.type)};case"pair":return{case:"pair",part1:E(a,e.part1),part2:E(a,e.part2),type:S(a,e.type)};case"proj1":return{case:"proj1",argument:E(a,e.argument),type:S(a,e.type)};case"proj2":return{case:"proj2",argument:E(a,e.argument),type:S(a,e.type)};case"hole":return{case:"hole",id:e.id,type:S(a,e.type)}}}function C(a){var e=new Map;return function a(t,r){switch(r.case){case"unit":case"variable":return;case"abstraction":switch(r.type.case){case"arrow":return void a({case:"cons",head:r.type.domain,tail:t},r.body);default:throw new Error("impossible")}case"application":a(t,r.applicant),a(t,r.argument);break;case"pair":a(t,r.part1),a(t,r.part2);break;case"proj1":case"proj2":return void a(t,r.argument);case"hole":e.set(r.id,l(t))}}({case:"nil"},a),e}function N(a,e,t){switch(t.case){case"unit":return t;case"variable":return t.id===a?e:t;case"arrow":return{case:"arrow",domain:N(a,e,t.domain),codomain:N(a,e,t.codomain)};case"product":return{case:"product",part1:N(a,e,t.part1),part2:N(a,e,t.part2)}}}function S(a,e){return e=function a(e,t){switch(e.case){case"nil":return t;case"cons":return t=a(e.tail,t),t=N(e.key,e.value,t)}}(a,e)}function A(a,e){switch(a.case){case"unit":switch(e.case){case"unit":return{case:"nil"};case"variable":return g(e.id,a);case"arrow":case"product":throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)))}break;case"variable":switch(e.case){case"unit":return g(a.id,e);case"variable":return a.id===e.id?{case:"nil"}:g(a.id,e);case"arrow":case"product":if(M(a.id,e))throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)," because of circularity on ").concat(b(a.id)));return g(a.id,e)}break;case"arrow":switch(e.case){case"unit":throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)));case"variable":if(M(e.id,a))throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)," because of circularity on ").concat(b(e.id)));return g(e.id,a);case"arrow":return j(A(a.domain,e.domain),A(e.codomain,a.codomain));case"product":throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)))}break;case"product":switch(e.case){case"unit":throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)));case"variable":if(M(e.id,a))throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)," because of circularity on ").concat(b(e.id)));return g(e.id,a);case"arrow":throw new Error("cannot unify ".concat(v(a)," with ").concat(v(e)));case"product":return j(A(a.part1,e.part1),A(a.part2,e.part2))}}throw new Error("impossible: ".concat(v(a)," ~ ").concat(v(e)))}function M(a,e){switch(e.case){case"unit":return!1;case"variable":return a===e.id;case"arrow":return M(a,e.domain)||M(a,e.codomain);case"product":return M(a,e.part1)||M(a,e.part2)}}function F(a){switch(a.case){case"unit":return{case:"unit"};case"variable":case"abstraction":case"application":case"pair":case"proj1":case"proj2":case"hole":return a.type}}function P(a){var e=0;function t(a){switch(a.case){case"unit":return;case"variable":return void(e=Math.max(e,a.id));case"arrow":return t(a.domain),void t(a.codomain);case"product":return t(a.part1),void t(a.part2)}}return function(a){var e=[];return function a(t){switch(t.case){case"unit":return;case"variable":return void e.push(t.type);case"abstraction":return e.push(t.type),void a(t.body);case"application":return e.push(t.type),a(t.applicant),void a(t.argument);case"pair":return e.push(t.type),a(t.part1),void a(t.part2);case"proj1":case"proj2":return e.push(t.type),void a(t.argument);case"hole":return void e.push(t.type)}}(a),e}(a).forEach((function(a){return t(a)})),e+1}function B(a){switch(a.case){case"unit":return"unit";case"variable":return m(a.id);case"abstraction":return"\u03bb ?";case"application":return"? ?";case"pair":return"(? , ?)";case"proj1":return"\u03c0\u2081 ?";case"proj2":return"\u03c0\u2082 ?"}}function G(a,e){switch(e.case){case"select":var t,r=O(a.term),c=function(a,e){var t=void 0;if(function a(r){switch(r.case){case"unit":case"variable":return;case"abstraction":return void a(r.body);case"application":return a(r.applicant),void a(r.argument);case"pair":return a(r.part1),void a(r.part2);case"proj1":case"proj2":return void a(r.argument);case"hole":r.id===e&&(t=r.type)}}(a),void 0!==t)return t;throw new Error("hole id ".concat(e," not found"))}(r.termAnn,e.id),n=C(r.termAnn),i=[];n.forEach((function(a,e){return i.push("".concat(w(e),": ").concat(k(a)))}));var s=n.get(e.id);if(void 0===s)throw new Error("hole id ".concat(e.id," not found among hole contexts"));t=s;var o=[],u=[];return u.push({case:"unit"}),u.push({case:"application"}),u.push({case:"abstraction"}),u.push({case:"pair"}),u.push({case:"proj1"}),u.push({case:"proj2"}),d(t).forEach((function(a,e){return u.push({case:"variable",id:e})})),u.forEach((function(t){var r;switch(t.case){case"unit":r={case:"unit"};break;case"variable":r={case:"variable",id:t.id};break;case"abstraction":r={case:"abstraction",body:{case:"hole",id:-1}};break;case"application":r={case:"application",applicant:{case:"hole",id:-1},argument:{case:"hole",id:-1}};break;case"pair":r={case:"pair",part1:{case:"hole",id:-1},part2:{case:"hole",id:-1}};break;case"proj1":r={case:"proj1",argument:{case:"hole",id:-1}};break;case"proj2":r={case:"proj2",argument:{case:"hole",id:-1}}}var c=I(a.term,e.id,r);c=J(c);try{O(c),o.push({case:"put",put:t})}catch(n){console.log("failed inference: ".concat(n))}})),{term:a.term,type:r.type,focus:{id:e.id,type:c,context:t,transitions:o}};case"put":var p,l=a.focus;switch(e.put.case){case"unit":p={case:"unit"};break;case"variable":p={case:"variable",id:e.put.id};break;case"abstraction":p={case:"abstraction",body:{case:"hole",id:-1}};break;case"application":p={case:"application",applicant:{case:"hole",id:-1},argument:{case:"hole",id:-1}};break;case"pair":p={case:"pair",part1:{case:"hole",id:-1},part2:{case:"hole",id:-1}};break;case"proj1":p={case:"proj1",argument:{case:"hole",id:-1}};break;case"proj2":p={case:"proj2",argument:{case:"hole",id:-1}}}var h=I(a.term,l.id,p);return{term:h=J(h),type:O(h).type,focus:void 0}}throw new Error("unimplemented")}function I(a,e,t){switch(a.case){case"unit":case"variable":return a;case"abstraction":return{case:"abstraction",body:I(a.body,e,t)};case"application":return{case:"application",applicant:I(a.applicant,e,t),argument:I(a.argument,e,t)};case"pair":return{case:"pair",part1:I(a.part1,e,t),part2:I(a.part2,e,t)};case"proj1":return{case:"proj1",argument:I(a.argument,e,t)};case"proj2":return{case:"proj2",argument:I(a.argument,e,t)};case"hole":return a.id===e?t:a}}function J(a){var e=0;return a=function a(t){switch(t.case){case"unit":case"variable":return t;case"abstraction":return{case:"abstraction",body:a(t.body)};case"application":return{case:"application",applicant:a(t.applicant),argument:a(t.argument)};case"pair":return{case:"pair",part1:a(t.part1),part2:a(t.part2)};case"proj1":return{case:"proj1",argument:a(t.argument)};case"proj2":return{case:"proj2",argument:a(t.argument)};case"hole":return function(){var a={case:"hole",id:e};return e++,a}()}}(a)}var L=t(0),T=function(a){Object(u.a)(t,a);var e=Object(p.a)(t);function t(){var a;Object(s.a)(this,t);for(var r=arguments.length,c=new Array(r),n=0;n<r;n++)c[n]=arguments[n];return(a=e.call.apply(e,[this].concat(c))).state={term:{case:"hole",id:0},type:{case:"variable",id:0},focus:void 0},a}return Object(o.a)(t,[{key:"render",value:function(){return Object(L.jsxs)("div",{className:"App",children:[this.viewConsole(),this.viewEnvironment(),this.viewPalette()]})}},{key:"viewEnvironment",value:function(){return void 0!==this.state.focus?Object(L.jsxs)("div",{className:"environment",children:[this.viewContext(),Object(L.jsx)("hr",{}),this.viewGoal()]}):Object(L.jsx)("div",{})}},{key:"viewContext",value:function(){if(void 0!==this.state.focus){var a=[];return d(this.state.focus.context).forEach((function(e,t){return a.push(Object(L.jsxs)("div",{className:"context-variable",children:[m(t),": ",v(e)]}))})),Object(L.jsx)("div",{className:"context",children:a})}return Object(L.jsx)("div",{})}},{key:"viewGoal",value:function(){return void 0!==this.state.focus?Object(L.jsx)("div",{className:"goal",children:v(this.state.focus.type)}):Object(L.jsx)("div",{})}},{key:"viewConsole",value:function(){var a=this;return Object(L.jsxs)("div",{className:"console",children:[function e(t){switch(t.case){case"unit":case"variable":return Object(L.jsx)("span",{children:f(t)});case"abstraction":var r=e(t.body);return Object(L.jsxs)("span",{children:["(\u03bb ",r,")"]});case"application":var c=e(t.applicant),n=e(t.argument);return Object(L.jsxs)("span",{children:["(",c," ",n,")"]});case"pair":var i=e(t.part1),s=e(t.part2);return Object(L.jsxs)("span",{children:["(",i,", ",s,")"]});case"proj1":var o=e(t.argument);return Object(L.jsxs)("span",{children:["(\u03c0\u2081 ",o,")"]});case"proj2":var u=e(t.argument);return Object(L.jsxs)("span",{children:["(\u03c0\u2082 ",u,")"]});case"hole":var p=void 0!==a.state.focus&&a.state.focus.id===t.id?"hole focussed":"hole";return Object(L.jsx)("span",{className:p,onClick:function(e){return a.setState(G(a.state,{case:"select",id:t.id}))},children:w(t.id)})}}(this.state.term)," : ",v(this.state.type)]})}},{key:"viewPalette",value:function(){if(void 0!==this.state.focus){var a=this,e=[];return this.state.focus.transitions.forEach((function(t){switch(t.case){case"select":break;case"put":e.push(Object(L.jsx)("div",{children:Object(L.jsx)("div",{className:"palette-item",onClick:function(e){return a.setState(G(a.state,t))},children:B(t.put)})}))}})),Object(L.jsx)("div",{className:"palette",children:e})}return Object(L.jsx)("div",{})}}]),t}(c.a.Component),q=function(a){a&&a instanceof Function&&t.e(3).then(t.bind(null,16)).then((function(e){var t=e.getCLS,r=e.getFID,c=e.getFCP,n=e.getLCP,i=e.getTTFB;t(a),r(a),c(a),n(a),i(a)}))};i.a.render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(T,{})}),document.getElementById("root")),q()}},[[15,1,2]]]);
//# sourceMappingURL=main.b51cabbc.chunk.js.map